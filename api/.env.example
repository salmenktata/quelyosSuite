# API
PORT=3004

# Secrets (REQUIRED - generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))")
JWT_SECRET=your-super-secret-jwt-key-min-32-characters-required-change-me-in-production
# Cookie signing secret (should be different from JWT_SECRET, min 32 chars)
# Falls back to JWT_SECRET if not set, but recommended to use separate secret
COOKIE_SECRET=

# CORS Configuration (REQUIRED for cookie-based auth)
CORS_ORIGIN=http://localhost:3005
CORS_ORIGINS=http://localhost:3000,http://localhost:3001,http://localhost:3002,http://localhost:3007,http://localhost:3008,http://localhost:3009,http://localhost:3010,http://184.174.32.177:3000,http://184.174.32.177:3001,http://184.174.32.177:3002,http://184.174.32.177:3007,http://184.174.32.177:3008,http://184.174.32.177:3009,http://184.174.32.177:3010
# MUST be true for httpOnly cookies to work
CORS_ALLOW_CREDENTIALS=true

# Cookie Configuration
# Leave empty for development (localhost), set to .quelyos.com for production subdomain sharing
COOKIE_DOMAIN=

# Sentry Monitoring
SENTRY_DSN=
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1
SENTRY_RELEASE=
SERVER_NAME=quelyos-finance-api

# Tokens
ACCESS_TOKEN_EXPIRY=15m
REFRESH_TOKEN_EXPIRY_DAYS=7

# Security / rate limiting
RATE_LIMIT_LOGIN=5
RATE_LIMIT_LOGIN_WINDOW=900
RATE_LIMIT_AUTHED=300
RATE_LIMIT_AUTHED_WINDOW=300
RATE_LIMIT_RESET=3
RATE_LIMIT_RESET_WINDOW=3600
RATE_LIMIT_RESET_SHORT=5
RATE_LIMIT_RESET_SHORT_WINDOW=900

# Password reset
RESET_TOKEN_TTL_MIN=15
RESET_FRONT_URL=http://localhost:3000/reset
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_USER=
SMTP_PASS=
SMTP_FROM=no-reply@quelyos.com

# Brevo Email API (for cash alerts and notifications)
# Get your API key from: https://app.brevo.com/settings/keys/api
BREVO_API_KEY=your-brevo-api-key-here
BREVO_SENDER_EMAIL=noreply@quelyos.com

# Audit / CSP
AUDIT_LOG_PATH=./logs/audit.log
CSP_CONNECT_SRC_EXTRA=

# Database
DATABASE_URL=postgresql://quelyos:changeme@localhost:5432/quelyos_finance
TEST_DATABASE_URL=postgresql://quelyos:changeme@localhost:5432/quelyos_finance_test
NODE_ENV=development

# Auto-seed user démo au démarrage (true en dev/staging)
# Credentials: demo@quelyos.com / demo123456
SEED_ON_START=true

# ═════════════════════════════════════════════════════════════════════════════
# S3/MINIO STORAGE CONFIGURATION (For RH documents)
# ═════════════════════════════════════════════════════════════════════════════

# S3/MinIO Configuration
S3_ENDPOINT=http://localhost:9000
S3_REGION=us-east-1
S3_ACCESS_KEY_ID=quelyos_admin
S3_SECRET_ACCESS_KEY=secure_minio_password_2024
S3_DOCUMENTS_BUCKET=rh-documents
S3_PHOTOS_BUCKET=rh-photos
S3_FORCE_PATH_STYLE=true

# ClamAV Antivirus (optional - for file scanning)
CLAMAV_HOST=localhost
CLAMAV_PORT=3310

# ═════════════════════════════════════════════════════════════════════════════
# STRIPE BILLING CONFIGURATION
# ═════════════════════════════════════════════════════════════════════════════

# Stripe API Keys (Get from https://dashboard.stripe.com/apikeys)
STRIPE_SECRET_KEY=sk_test_... # Test secret key for development
STRIPE_PUBLISHABLE_KEY=pk_test_... # Test publishable key (for frontend)

# Stripe Webhook Secret (Get from https://dashboard.stripe.com/webhooks)
# Used to verify webhook signatures
STRIPE_WEBHOOK_SECRET=whsec_...

# Stripe Price IDs (Create products/prices in Stripe Dashboard)
# Pro Plan
STRIPE_PRICE_PRO_MONTHLY=price_... # 19€/month
STRIPE_PRICE_PRO_YEARLY=price_... # 190€/year (save 2 months)

# Expert Plan
STRIPE_PRICE_EXPERT_MONTHLY=price_... # 49€/month per user
STRIPE_PRICE_EXPERT_YEARLY=price_... # 490€/year per user

# Frontend URL (for Stripe checkout redirect URLs)
FRONTEND_URL=http://localhost:3007

# ═════════════════════════════════════════════════════════════════════════════
# HOW TO SET UP STRIPE:
# ═════════════════════════════════════════════════════════════════════════════
#
# 1. Create a Stripe account: https://dashboard.stripe.com/register
# 2. Get your API keys: https://dashboard.stripe.com/apikeys
#    - Copy the "Secret key" (starts with sk_test_) to STRIPE_SECRET_KEY
#    - Copy the "Publishable key" (starts with pk_test_) to STRIPE_PUBLISHABLE_KEY
#
# 3. Create Products & Prices:
#    a) Go to: https://dashboard.stripe.com/products/create
#    b) Create "Quelyos Pro":
#       - Name: Quelyos Pro
#       - Description: Pour les indépendants & TPE
#       - Add two prices:
#         * Monthly: 19 EUR
#         * Yearly: 190 EUR (save 38€/year)
#       - Copy the Price IDs to STRIPE_PRICE_PRO_MONTHLY and STRIPE_PRICE_PRO_YEARLY
#
#    c) Create "Quelyos Expert":
#       - Name: Quelyos Expert
#       - Description: Pour les équipes & multi-sociétés
#       - Pricing model: Per user
#       - Add two prices:
#         * Monthly: 49 EUR per user
#         * Yearly: 490 EUR per user
#       - Copy the Price IDs to STRIPE_PRICE_EXPERT_MONTHLY and STRIPE_PRICE_EXPERT_YEARLY
#
# 4. Set up Webhooks:
#    a) Go to: https://dashboard.stripe.com/webhooks/create
#    b) Endpoint URL: https://your-domain.com/billing/webhooks
#    c) Events to send:
#       - customer.subscription.created
#       - customer.subscription.updated
#       - customer.subscription.deleted
#       - invoice.payment_succeeded
#       - invoice.payment_failed
#    d) Copy the "Signing secret" (starts with whsec_) to STRIPE_WEBHOOK_SECRET
#
# 5. For local testing with webhooks, use Stripe CLI:
#    stripe listen --forward-to localhost:3004/billing/webhooks
#
# ═════════════════════════════════════════════════════════════════════════════
